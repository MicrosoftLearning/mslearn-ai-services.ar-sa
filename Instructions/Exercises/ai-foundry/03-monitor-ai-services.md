---
lab:
  title: مراقبة خدمات الذكاء الاصطناعي في Azure
  module: Module 2 - Developing AI Apps with Azure AI Services
---

# مراقبة خدمات الذكاء الاصطناعي في Azure

يمكن أن تكون خدمات الذكاء الاصطناعي في Azure جزءًا أساسيًا من البنية الأساسية الشاملة للتطبيق. من الأهمية بمكان أن تكون قادرًا على مراقبة النشاط والحصول على تنبيهات بشأن المشكلات التي قد تحتاج إلى الاهتمام.

## نسخ المستودع في تعليمة Visual Studio البرمجية

ستقوم بتطوير تطبيقك باستخدام التعليمة البرمجية في Visual Studio. تم توفير ملفات التعليمات البرمجية لتطبيقك في GitHub repo.

> **تلميح**: إذا نسخت بالفعل مستودع **mslearn-ai-services**، فافتحه في تعليمة Visual Studio البرمجية. وإلا فاتبع هذه الخطوات لاستنساخه إلى بيئة تطويرك.

1. ابدأ تشغيل Visual Studio Code.
2. افتح لوحة (SHIFT+CTRL+P) وشغّل **Git: استنسخ الأمر ** لاستنساخ مستودع `https://github.com/MicrosoftLearning/mslearn-ai-services` إلى مجلد محلي (لا يُهم أي مجلد).
3. عند استنساخ المستودع، افتح المجلد في تعليمة Visual Studio البرمجية.
4. انتظر حتى تثبيت ملفات إضافية لدعم مشاريع التعليمات البرمجية C# في المستودع عند الضرورة

    > **ملاحظة**: إذا جرت مطالبتك بإضافة الأصول المطلوبة للبناء وتصحيح الأخطاء، فحدد **ليس الآن**.

5. قم بتوسيع مجلد `Labfiles/03-monitor-ai-services`.

## توفير مورد خدمات الذكاء الاصطناعي في Azure

إذا لم يكن لديك بالفعل مورد في اشتراكك، فسيتعين عليك توفير مورد **خدمات الذكاء الاصطناعي في Azure**.

1. افتح مدخل Azure على `https://portal.azure.com`، وسجل الدخول باستخدام حساب Microsoft المقترن باشتراك Azure.
2. في شريط البحث العلوي، ابحث عن *خدمات الذكاء الاصطناعي في Azure*، وحدد **خدمات الذكاء الاصطناعي في Azure**، وأنشئ مورد حساب متعدد الخدمات لخدمات الذكاء الاصطناعي في Azure بالإعدادات التالية:
    - **Subscription**: *اشتراكك في Azure*
    - **مجموعة الموارد**: *اختر أو أنشئ مجموعة موارد (إذا كنت تستخدم اشتراكًا مقيدًا، فقد لا يكون لديك إذن لإنشاء مجموعة موارد جديدة - استخدم المجموعة المتوفرة)*
    - **المنطقة**: *اختر أي منطقة متوفرة*
    - **الاسم**: *أدخل اسماً فريداً*
    - **مستوى التسعير**: قياسي S0
3. حدِّد أي مربعات اختيار مطلوبة ثم أنشئ المورد.
4. انتظر حتى يكتمل النشر، ثم اعرض تفاصيل النشر.
5. عند نشر المورد، انتقل إليه واعرض **صفحة المفاتيح ونقطة النهاية** الخاصة به. دوِّن معرف RI الخاص بنقطة النهاية - سوف تحتاج إليه لاحقًا.

## تكوين تنبيه

لنبدأ عملية المراقبة من خلال تحديد قاعدة تنبيه حتى تتمكن من اكتشاف النشاط في مورد خدمات الذكاء الاصطناعي في Azure الخاص بك.

1. في مدخل Microsoft Azure، انتقِل إلى مورد خدمات الذكاء الاصطناعي في Azure واعرض صفحة **التنبيهات** الخاصة به (في قسم **المراقبة**).
2. حدد القائمة المنسدلة **+ إنشاء**، ثم حدد **قاعدة التنبيه**
3. في صفحة **إنشاء قاعدة تنبيه**، ضمن **النطاق**، تأكد من إدراج مورد خدمات الذكاء الاصطناعي في Azure الخاص بك. (إغلاق جزء **تحديد إشارة** إذا كان مفتوحًا)
4. حدد علامة التبويب **الشرط**، ثم حدد الرابط **عرض كل الإشارات** لإظهار جزء **تحديد إشارة** الذي يظهر على اليمين، حيث يمكنك تحديد نوع إشارة لمراقبتها.
5. في قائمة **نوع الإشارة**، قم بالتمرير لأسفل إلى قسم **سجل النشاط**، ثم حدد **قائمة المفاتيح (حساب واجهة برمجة التطبيقات للخدمات المعرفية)**. ثم حدد **تطبيق**.
6. راجع النشاط خلال الساعات الست الماضية.
7. حدد علامة التبويب **إجراءات**. لاحظ أنه يمكنك تحديد *مجموعة إجراءات*. يتيح لك هذا تكوين إجراءات تلقائية عند إطلاق تنبيه - على سبيل المثال، إرسال إعلام بريد إلكتروني. لن نفعل ذلك في هذا التمرين؛ ولكن قد يكون من المفيد القيام بذلك في بيئة التشغيل.
8. في علامة التبويب **التفاصيل**، قم بتعيين **اسم قاعدة التنبيه** إلى **تنبيه القائمة الرئيسية**.
9. حدد "**Review + create**". 
10. راجع تكوين التنبيه. حدد **إنشاء** وانتظر حتى يتم إنشاء قاعدة التنبيه.
11. يمكنك الآن استخدام الأمر التالي للحصول على قائمة مفاتيح خدمات الذكاء الاصطناعي في Azure، واستبدال *&lt;اسم المورد&gt;* باسم مورد خدمات الذكاء الاصطناعي في Azure، و*&lt;مجموعة الموارد&gt;* باسم مجموعة الموارد التي قمت بإنشائها فيها.

    ```
    az cognitiveservices account keys list --name <resourceName> --resource-group <resourceGroup>
    ```

    يقوم الأمر بعرض قائمة بالمفاتيح الخاصة بمورد خدمات الذكاء الاصطناعي في Azure الخاص بك.

    > **ملاحظة** إذا لم تقم بتسجيل الدخول إلى Azure CLI، فقد تحتاج إلى التشغيل `az login` قبل أن يعمل أمر مفاتيح القائمة.

12. قم بالرجوع إلى المستعرض الذي يحتوي على مدخل Microsoft Azure، ثم قم بتحديث **صفحة التنبيهات** الخاصة بك. يجب أن ترى تنبيه **Sev 4** مدرجًا في الجدول (إذا لم يكن كذلك، فانتظر لمدة تصل إلى خمس دقائق ثم قم بالتحديث مرة أخرى).
13. حدد التنبيه للاطّلاع على تفاصيله.

## اعرض مقياسًا بشكل بياني

بالإضافة إلى تحديد التنبيهات، يمكنك عرض المقاييس الخاصة بموارد خدمات الذكاء الاصطناعي في Azure لمراقبة استخدامها.

1. في مدخل Microsoft Azure، في الصفحة الخاصة بمورد خدمات الذكاء الاصطناعي في Azure، حدد **المقاييس** (في قسم **المراقبة**).
2. إذا لم يكن هناك مخطط موجود، فحدد **+ مخطط جديد**. بعد ذلك في قائمة **المقاييس**، راجع المقاييس المحتملة التي يمكنك عرضها بشكل بياني وحدد **إجمالي المكالمات**.
3. في قائمة **Aggregation**، حدد **Count**.  سيسمح لك هذا الأمر بمراقبة إجمالي المكالمات الواردة إلى مورد خدمة الذكاء الاصطناعي في Azure الخاص بك؛ الأمر الذي يعد مفيدًا في تحديد مقدار استخدام الخدمة على مدار فترة زمنية.
4. لإنشاء بعض الطلبات إلى خدمة الذكاء الاصطناعي في Azure الخاصة بك، سوف تستخدم **curl** - أداة سطر أوامر لطلبات HTTP. في المحرر الخاص بك، افتح **rest-test.cmd** وقم بتحرير أمر **curl** الذي يحتوي عليه (كما هو موضح أدناه)، واستبدل *&lt;yourEndpoint&gt;* و*&lt;yourKey&gt;* بمعرف URI لنقطة النهاية ومفتاح **Key1** لاستخدام واجهة برمجة تطبيقات تحليلات النصوص في مورد خدمات الذكاء الاصطناعي في Azure الخاص بك.

    ```
    curl -X POST "<your-endpoint>/language/:analyze-text?api-version=2023-04-01" -H "Content-Type: application/json" -H "Ocp-Apim-Subscription-Key: <your-key>" --data-ascii "{'analysisInput':{'documents':[{'id':1,'text':'hello'}]}, 'kind': 'LanguageDetection'}"
    ```

5. احفظ التغييرات، ثم شغّل الأمر التالي:

    ```
    ./rest-test.cmd
    ```

    يظهر الأمر مستند JSON يحتوي على معلومات حول اللغة المكتشفة في بيانات الإدخال (والتي يجب أن تكون الإنجليزية).

6. أعِد تشغيل أمر **rest-test** عدة مرات لإنشاء بعض نشاط المكالمة (يمكنك استخدام المفتاح **^** للتنقل بين الأوامر السابقة).
7. ارجع إلى صفحة **المقاييس** في مدخل Microsoft Azure وقم بتحديث مخطط **إجمالي المكالمات**. قد يستغرق الأمر بضع دقائق حتى تنعكس المكالمات التي أجريتها باستخدام *curl* في المخطط البياني - استمر في تحديث الرسم البياني حتى يتم تحديثه لتضمينها.

## تنظيف الموارد

إذا كنت لا تستخدم موارد Azure التي أنشأتها في هذا المختبر لوحدات التدريب الأخرى، فيمكنك حذفها لتجنب تكبد المزيد من الرسوم.

1. افتح مدخل Azure في `https://portal.azure.com`، وفي شريط البحث العلوي، ابحث عن الموارد التي أنشأتها في هذا المختبر.

2. في صفحة المورد، حدد **حذف** واتبع الإرشادات لحذف المورد. بدلاً من ذلك، يمكنك حذف مجموعة الموارد بأكملها لتنظيف جميع الموارد في الوقت نفسه.

## مزيد من المعلومات

أحد الخيارات لمراقبة خدمات الذكاء الاصطناعي في Azure هو استخدام *تسجيل التشخيص*. بمجرد تمكينه، يقوم تسجيل التشخيص بالتقاط معلومات ثرية حول استخدام موارد خدمات الذكاء الاصطناعي في Azure الخاصة بك، ويمكن أن يكون أداة مراقبة وتصحيح أخطاء مفيدة. قد يستغرق الأمر أكثر من ساعة بعد إعداد التسجيل التشخيصي لإنشاء أي معلومات، وهذا هو السبب في أننا لم نستكشفه في هذا التمرين؛ ولكن يمكنك معرفة المزيد عنه في [وثائق خدمات الذكاء الاصطناعي في Azure](https://docs.microsoft.com/azure/ai-services/diagnostic-logging).
